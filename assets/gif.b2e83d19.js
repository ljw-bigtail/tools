var Te=Object.defineProperty;var ee=Object.getOwnPropertySymbols;var _e=Object.prototype.hasOwnProperty,Fe=Object.prototype.propertyIsEnumerable;var le=(e,t,o)=>t in e?Te(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,X=(e,t)=>{for(var o in t||(t={}))_e.call(t,o)&&le(e,o,t[o]);if(ee)for(var o of ee(t))Fe.call(t,o)&&le(e,o,t[o]);return e};var xe=(e,t)=>{var o={};for(var n in e)_e.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(e!=null&&ee)for(var n of ee(e))t.indexOf(n)<0&&Fe.call(e,n)&&(o[n]=e[n]);return o};var V=(e,t,o)=>(le(e,typeof t!="symbol"?t+"":t,o),o);import{g as Le,_ as M,d as Y,r as L,o as O,h as D,a as d,i as E,j as H,v as Re,k as te,p as ae,e as oe,l as Ge,m as Me,F as Se,n as Ne,q as Ve,t as qe,s as Ye,u as he,x as We,y as Xe,z as de,A as ke,B as ce,c as Ze,w as z,b as He,C as Je,f as Ke}from"./plugin-vue_export-helper.1e4d075f.js";import{c as Qe,F as et,S as tt,R as at,L as Pe,I as ot,T as it,a as ue,G as nt,b as rt}from"./Line.5eeb8944.js";var st={exports:{}};(function(e){var t=function(o){var n=Object.prototype,l=n.hasOwnProperty,s,g=typeof Symbol=="function"?Symbol:{},v=g.iterator||"@@iterator",c=g.asyncIterator||"@@asyncIterator",m=g.toStringTag||"@@toStringTag";function h(i,a,r){return Object.defineProperty(i,a,{value:r,enumerable:!0,configurable:!0,writable:!0}),i[a]}try{h({},"")}catch{h=function(a,r,p){return a[r]=p}}function F(i,a,r,p){var u=a&&a.prototype instanceof w?a:w,k=Object.create(u.prototype),P=new ne(p||[]);return k._invoke=Ue(i,r,P),k}o.wrap=F;function b(i,a,r){try{return{type:"normal",arg:i.call(a,r)}}catch(p){return{type:"throw",arg:p}}}var x="suspendedStart",R="suspendedYield",G="executing",I="completed",C={};function w(){}function y(){}function f(){}var _={};h(_,v,function(){return this});var $=Object.getPrototypeOf,U=$&&$($(re([])));U&&U!==n&&l.call(U,v)&&(_=U);var S=f.prototype=w.prototype=Object.create(_);y.prototype=f,h(S,"constructor",f),h(f,"constructor",y),y.displayName=h(f,m,"GeneratorFunction");function K(i){["next","throw","return"].forEach(function(a){h(i,a,function(r){return this._invoke(a,r)})})}o.isGeneratorFunction=function(i){var a=typeof i=="function"&&i.constructor;return a?a===y||(a.displayName||a.name)==="GeneratorFunction":!1},o.mark=function(i){return Object.setPrototypeOf?Object.setPrototypeOf(i,f):(i.__proto__=f,h(i,m,"GeneratorFunction")),i.prototype=Object.create(S),i},o.awrap=function(i){return{__await:i}};function Q(i,a){function r(k,P,B,A){var j=b(i[k],i,P);if(j.type==="throw")A(j.arg);else{var se=j.arg,W=se.value;return W&&typeof W=="object"&&l.call(W,"__await")?a.resolve(W.__await).then(function(N){r("next",N,B,A)},function(N){r("throw",N,B,A)}):a.resolve(W).then(function(N){se.value=N,B(se)},function(N){return r("throw",N,B,A)})}}var p;function u(k,P){function B(){return new a(function(A,j){r(k,P,A,j)})}return p=p?p.then(B,B):B()}this._invoke=u}K(Q.prototype),h(Q.prototype,c,function(){return this}),o.AsyncIterator=Q,o.async=function(i,a,r,p,u){u===void 0&&(u=Promise);var k=new Q(F(i,a,r,p),u);return o.isGeneratorFunction(a)?k:k.next().then(function(P){return P.done?P.value:k.next()})};function Ue(i,a,r){var p=x;return function(k,P){if(p===G)throw new Error("Generator is already running");if(p===I){if(k==="throw")throw P;return ye()}for(r.method=k,r.arg=P;;){var B=r.delegate;if(B){var A=we(B,r);if(A){if(A===C)continue;return A}}if(r.method==="next")r.sent=r._sent=r.arg;else if(r.method==="throw"){if(p===x)throw p=I,r.arg;r.dispatchException(r.arg)}else r.method==="return"&&r.abrupt("return",r.arg);p=G;var j=b(i,a,r);if(j.type==="normal"){if(p=r.done?I:R,j.arg===C)continue;return{value:j.arg,done:r.done}}else j.type==="throw"&&(p=I,r.method="throw",r.arg=j.arg)}}}function we(i,a){var r=i.iterator[a.method];if(r===s){if(a.delegate=null,a.method==="throw"){if(i.iterator.return&&(a.method="return",a.arg=s,we(i,a),a.method==="throw"))return C;a.method="throw",a.arg=new TypeError("The iterator does not provide a 'throw' method")}return C}var p=b(r,i.iterator,a.arg);if(p.type==="throw")return a.method="throw",a.arg=p.arg,a.delegate=null,C;var u=p.arg;if(!u)return a.method="throw",a.arg=new TypeError("iterator result is not an object"),a.delegate=null,C;if(u.done)a[i.resultName]=u.value,a.next=i.nextLoc,a.method!=="return"&&(a.method="next",a.arg=s);else return u;return a.delegate=null,C}K(S),h(S,m,"Generator"),h(S,v,function(){return this}),h(S,"toString",function(){return"[object Generator]"});function ze(i){var a={tryLoc:i[0]};1 in i&&(a.catchLoc=i[1]),2 in i&&(a.finallyLoc=i[2],a.afterLoc=i[3]),this.tryEntries.push(a)}function ie(i){var a=i.completion||{};a.type="normal",delete a.arg,i.completion=a}function ne(i){this.tryEntries=[{tryLoc:"root"}],i.forEach(ze,this),this.reset(!0)}o.keys=function(i){var a=[];for(var r in i)a.push(r);return a.reverse(),function p(){for(;a.length;){var u=a.pop();if(u in i)return p.value=u,p.done=!1,p}return p.done=!0,p}};function re(i){if(i){var a=i[v];if(a)return a.call(i);if(typeof i.next=="function")return i;if(!isNaN(i.length)){var r=-1,p=function u(){for(;++r<i.length;)if(l.call(i,r))return u.value=i[r],u.done=!1,u;return u.value=s,u.done=!0,u};return p.next=p}}return{next:ye}}o.values=re;function ye(){return{value:s,done:!0}}return ne.prototype={constructor:ne,reset:function(i){if(this.prev=0,this.next=0,this.sent=this._sent=s,this.done=!1,this.delegate=null,this.method="next",this.arg=s,this.tryEntries.forEach(ie),!i)for(var a in this)a.charAt(0)==="t"&&l.call(this,a)&&!isNaN(+a.slice(1))&&(this[a]=s)},stop:function(){this.done=!0;var i=this.tryEntries[0],a=i.completion;if(a.type==="throw")throw a.arg;return this.rval},dispatchException:function(i){if(this.done)throw i;var a=this;function r(A,j){return k.type="throw",k.arg=i,a.next=A,j&&(a.method="next",a.arg=s),!!j}for(var p=this.tryEntries.length-1;p>=0;--p){var u=this.tryEntries[p],k=u.completion;if(u.tryLoc==="root")return r("end");if(u.tryLoc<=this.prev){var P=l.call(u,"catchLoc"),B=l.call(u,"finallyLoc");if(P&&B){if(this.prev<u.catchLoc)return r(u.catchLoc,!0);if(this.prev<u.finallyLoc)return r(u.finallyLoc)}else if(P){if(this.prev<u.catchLoc)return r(u.catchLoc,!0)}else if(B){if(this.prev<u.finallyLoc)return r(u.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(i,a){for(var r=this.tryEntries.length-1;r>=0;--r){var p=this.tryEntries[r];if(p.tryLoc<=this.prev&&l.call(p,"finallyLoc")&&this.prev<p.finallyLoc){var u=p;break}}u&&(i==="break"||i==="continue")&&u.tryLoc<=a&&a<=u.finallyLoc&&(u=null);var k=u?u.completion:{};return k.type=i,k.arg=a,u?(this.method="next",this.next=u.finallyLoc,C):this.complete(k)},complete:function(i,a){if(i.type==="throw")throw i.arg;return i.type==="break"||i.type==="continue"?this.next=i.arg:i.type==="return"?(this.rval=this.arg=i.arg,this.method="return",this.next="end"):i.type==="normal"&&a&&(this.next=a),C},finish:function(i){for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a];if(r.finallyLoc===i)return this.complete(r.completion,r.afterLoc),ie(r),C}},catch:function(i){for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a];if(r.tryLoc===i){var p=r.completion;if(p.type==="throw"){var u=p.arg;ie(r)}return u}}throw new Error("illegal catch attempt")},delegateYield:function(i,a,r){return this.delegate={iterator:re(i),resultName:a,nextLoc:r},this.method==="next"&&(this.arg=s),C}},o}(e.exports);try{regeneratorRuntime=t}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}})(st);var lt={defaultArgs:["./ffmpeg","-nostdin","-y"],baseOptions:{log:!1,logger:()=>{},progress:()=>{},corePath:""}};let me=!1,Be=()=>{};const dt=e=>{me=e},ct=e=>{Be=e},ut=(e,t)=>{Be({type:e,message:t}),me&&console.log(`[${e}] ${t}`)};var je={logging:me,setLogging:dt,setCustomLogger:ct,log:ut};let Z=0,fe=0;const $e=e=>{const[t,o,n]=e.split(":");return parseFloat(t)*60*60+parseFloat(o)*60+parseFloat(n)};var ft=(e,t)=>{if(typeof e=="string")if(e.startsWith("  Duration")){const o=e.split(", ")[0].split(": ")[1],n=$e(o);t({duration:n,ratio:fe}),(Z===0||Z>n)&&(Z=n)}else if(e.startsWith("frame")||e.startsWith("size")){const o=e.split("time=")[1].split(" ")[0],n=$e(o);fe=n/Z,t({ratio:fe,time:n})}else e.startsWith("video:")&&(t({ratio:1}),Z=0)},gt=(e,t)=>{const o=e._malloc(t.length*Uint32Array.BYTES_PER_ELEMENT);return t.forEach((n,l)=>{const s=e._malloc(n.length+1);e.writeAsciiToMemory(n,s),e.setValue(o+Uint32Array.BYTES_PER_ELEMENT*l,s,"i32")}),[t.length,o]},be={exports:{}};(function(e,t){(function(o,n){e.exports=n()})(Qe,function(){function o(){var n=arguments.length;if(n===0)throw new Error("resolveUrl requires at least one argument; got none.");var l=document.createElement("base");if(l.href=arguments[0],n===1)return l.href;var s=document.getElementsByTagName("head")[0];s.insertBefore(l,s.firstChild);for(var g=document.createElement("a"),v,c=1;c<n;c++)g.href=arguments[c],v=g.href,l.href=v;return s.removeChild(l),v}return o})})(be);const pt="@ffmpeg/ffmpeg",vt="0.10.1",ht="FFmpeg WebAssembly version",mt="src/index.js",bt="src/index.d.ts",wt={example:"examples"},yt={start:"node scripts/server.js",build:"rimraf dist && webpack --config scripts/webpack.config.prod.js",prepublishOnly:"npm run build",lint:"eslint src",wait:"rimraf dist && wait-on http://localhost:3000/dist/ffmpeg.dev.js",test:"npm-run-all -p -r start test:all","test:all":"npm-run-all wait test:browser:ffmpeg test:node:all","test:node":"node --experimental-wasm-threads --experimental-wasm-bulk-memory node_modules/.bin/_mocha --exit --bail --require ./scripts/test-helper.js","test:node:all":"npm run test:node -- ./tests/*.test.js","test:browser":"mocha-headless-chrome -a allow-file-access-from-files -a incognito -a no-sandbox -a disable-setuid-sandbox -a disable-logging -t 300000","test:browser:ffmpeg":"npm run test:browser -- -f ./tests/ffmpeg.test.html"},_t={"./src/node/index.js":"./src/browser/index.js"},Ft={type:"git",url:"git+https://github.com/ffmpegwasm/ffmpeg.wasm.git"},xt=["ffmpeg","WebAssembly","video"],kt="Jerome Wu <jeromewus@gmail.com>",$t="MIT",Et={url:"https://github.com/ffmpegwasm/ffmpeg.wasm/issues"},Ct={node:">=12.16.1"},Lt="https://github.com/ffmpegwasm/ffmpeg.wasm#readme",St={"is-url":"^1.2.4","node-fetch":"^2.6.1","regenerator-runtime":"^0.13.7","resolve-url":"^0.2.1"},Pt={"@babel/core":"^7.12.3","@babel/preset-env":"^7.12.1","@ffmpeg/core":"^0.10.0","@types/emscripten":"^1.39.4","babel-loader":"^8.1.0",chai:"^4.2.0",cors:"^2.8.5",eslint:"^7.12.1","eslint-config-airbnb-base":"^14.1.0","eslint-plugin-import":"^2.22.1",express:"^4.17.1",mocha:"^8.2.1","mocha-headless-chrome":"^2.0.3","npm-run-all":"^4.1.5","wait-on":"^5.3.0",webpack:"^5.3.2","webpack-cli":"^4.1.0","webpack-dev-middleware":"^4.0.0"};var Oe={name:pt,version:vt,description:ht,main:mt,types:bt,directories:wt,scripts:yt,browser:_t,repository:Ft,keywords:xt,author:kt,license:$t,bugs:Et,engines:Ct,homepage:Lt,dependencies:St,devDependencies:Pt};const{devDependencies:Bt}=Oe;var jt={corePath:`https://unpkg.com/@ffmpeg/core@${Bt["@ffmpeg/core"].substring(1)}/dist/ffmpeg-core.js`};const Ot=be.exports,{log:J}=je,ge=async(e,t)=>{J("info",`fetch ${e}`);const o=await(await fetch(e)).arrayBuffer();J("info",`${e} file size = ${o.byteLength} bytes`);const n=new Blob([o],{type:t}),l=URL.createObjectURL(n);return J("info",`${e} blob URL = ${l}`),l};var It=async({corePath:e})=>{if(typeof e!="string")throw Error("corePath should be a string!");const t=Ot(e),o=await ge(t,"application/javascript"),n=await ge(t.replace("ffmpeg-core.js","ffmpeg-core.wasm"),"application/wasm"),l=await ge(t.replace("ffmpeg-core.js","ffmpeg-core.worker.js"),"application/javascript");return typeof createFFmpegCore=="undefined"?new Promise(s=>{const g=document.createElement("script"),v=()=>{g.removeEventListener("load",v),J("info","ffmpeg-core.js script loaded"),s({createFFmpegCore,corePath:o,wasmPath:n,workerPath:l})};g.src=o,g.type="text/javascript",g.addEventListener("load",v),document.getElementsByTagName("head")[0].appendChild(g)}):(J("info","ffmpeg-core.js script is loaded already"),Promise.resolve({createFFmpegCore,corePath:o,wasmPath:n,workerPath:l}))};const At=be.exports,Dt=e=>new Promise((t,o)=>{const n=new FileReader;n.onload=()=>{t(n.result)},n.onerror=({target:{error:{code:l}}})=>{o(Error(`File could not be read! Code=${l}`))},n.readAsArrayBuffer(e)});var Ut=async e=>{let t=e;return typeof e=="undefined"?new Uint8Array:(typeof e=="string"?/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(e)?t=atob(e.split(",")[1]).split("").map(o=>o.charCodeAt(0)):t=await(await fetch(At(e))).arrayBuffer():(e instanceof File||e instanceof Blob)&&(t=await Dt(e)),new Uint8Array(t))};const zt=jt,Tt=It,Rt=Ut;var Ie={defaultOptions:zt,getCreateFFmpegCore:Tt,fetchFile:Rt};const{defaultArgs:Gt,baseOptions:Mt}=lt,{setLogging:Ee,setCustomLogger:Ce,log:q}=je,Nt=ft,Vt=gt,{defaultOptions:qt,getCreateFFmpegCore:Yt}=Ie,{version:Wt}=Oe,pe=Error("ffmpeg.wasm is not ready, make sure you have completed load().");var Xt=(e={})=>{const y=X(X(X({},Mt),qt),e),{log:t,logger:o,progress:n}=y,l=xe(y,["log","logger","progress"]);let s=null,g=null,v=null,c=!1,m=n;const h=f=>{f==="FFMPEG_END"&&v!==null&&(v(),v=null,c=!1)},F=({type:f,message:_})=>{q(f,_),Nt(_,m),h(_)},b=async()=>{if(q("info","load ffmpeg-core"),s===null){q("info","loading ffmpeg-core");const{createFFmpegCore:f,corePath:_,workerPath:$,wasmPath:U}=await Yt(l);s=await f({mainScriptUrlOrBlob:_,printErr:S=>F({type:"fferr",message:S}),print:S=>F({type:"ffout",message:S}),locateFile:(S,K)=>{if(typeof window!="undefined"){if(typeof U!="undefined"&&S.endsWith("ffmpeg-core.wasm"))return U;if(typeof $!="undefined"&&S.endsWith("ffmpeg-core.worker.js"))return $}return K+S}}),g=s.cwrap("proxy_main","number",["number","number"]),q("info","ffmpeg-core loaded")}else throw Error("ffmpeg.wasm was loaded, you should not load it again, use ffmpeg.isLoaded() to check next time.")},x=()=>s!==null,R=(...f)=>{if(q("info",`run ffmpeg command: ${f.join(" ")}`),s===null)throw pe;if(c)throw Error("ffmpeg.wasm can only run one command at a time");return c=!0,new Promise(_=>{const $=[...Gt,...f].filter(U=>U.length!==0);v=_,g(...Vt(s,$))})},G=(f,..._)=>{if(q("info",`run FS.${f} ${_.map($=>typeof $=="string"?$:`<${$.length} bytes binary file>`).join(" ")}`),s===null)throw pe;{let $=null;try{$=s.FS[f](..._)}catch{throw Error(f==="readdir"?`ffmpeg.FS('readdir', '${_[0]}') error. Check if the path exists, ex: ffmpeg.FS('readdir', '/')`:f==="readFile"?`ffmpeg.FS('readFile', '${_[0]}') error. Check if the path exists`:"Oops, something went wrong in FS operation.")}return $}},I=()=>{if(s===null)throw pe;c=!1,s.exit(1),s=null,g=null,v=null},C=f=>{m=f},w=f=>{Ce(f)};return Ee(t),Ce(o),q("info",`use ffmpeg.wasm v${Wt}`),{setProgress:C,setLogger:w,setLogging:Ee,load:b,isLoaded:x,run:R,exit:I,FS:G}};const Zt=Xt,{fetchFile:Ht}=Ie;var ve={createFFmpeg:Zt,fetchFile:Ht};class Jt{constructor(t){V(this,"options");this.options=t}async transforms(t){return Promise.all(t.map(async o=>await this.transform(o)))}async transform(t){const o=await this._loadImg(t.file),n=this._paintFrame({img:o,frame:t});return await this._canvasToBlob(n)}async _canvasToBlob(t){return new Promise(function(o,n){t.toBlob(function(l){l?o(l):n("\u6570\u636E\u5F02\u5E38")},"image/jpeg",1)})}_canvasToImage(t){var o=new Image;return o.src=t.toDataURL("image/png"),o}async _loadImg(t){return new Promise(function(o){const n=new Image;n.src=window.URL.createObjectURL(t),n.onload=function(){o(n)}})}_paintFrame(t){const{width:o,height:n,rule:l,background:s}=this.options,{img:g,frame:v}=t,c=document.createElement("canvas");c.width=o,c.height=n;const m=c.getContext("2d");if(!g||!m)throw new Error("\u6570\u636E\u5F02\u5E38");m.fillStyle=s,m.fillRect(0,0,c.width,c.height);const{width:h,height:F}=g,{width:b,height:x}=c,R=F/h;function G(){if(l==2){const w=x>=F?x/F:1,y=b>=h?b/h:1,f=Math.min(w,y);let _=[0,0];f==w?_=[(b-h*f)/2,0]:_=[0,(x-F*f)/2];const $=[h*f,h*f*R];return[..._,...$]}else if(l==3){const w=x>=F?x/F:1,y=b>=h?b/h:1,f=Math.max(w,y);let _=[0,0];f==w?_=[(b-h*f)/2,0]:_=[0,(x-F*f)/2];const $=[h*f,h*f*R];return[..._,...$]}return[0,0,b,x]}const I=G();function C(w,y){const f=y==180?-1:1;w.translate((c.width-g.width*f)/2,0),w.scale(f,1),w.drawImage(g,...I),w.setTransform(1,0,0,1,0,0)}return C(m,v.rotateY),c}}class Kt{constructor(){V(this,"buffer");V(this,"frames");V(this,"options");V(this,"music");V(this,"ffmpeg");this.buffer=null,this.frames=[],this.options={width:900,height:1600,repeat:0,delay:750,background:"#FFFFFF",rule:3,quality:.5},this.music={start:0},this.ffmpeg=ve.createFFmpeg({log:!0,progress:t=>console.log(t)})}setOpt(t){return this.options=Object.assign(this.options,t),this}setFrame(t){return this.frames=t,this}setMusic(t){return this.music=t,this}setProgress({ratio:t}){console.log(t,"ratio")}async toPreView(){return await this._mixinMusic(),this.buffer?URL.createObjectURL(new Blob([this.buffer],{type:"video/mp4"})):""}async toFile(t){const o=`${t}-${Le()}.${t}`;if(this.buffer||await this._mixinMusic(),this.buffer){let n="";switch(t){case"gif":n="image/gif";break;case"mp4":n="video/mp4";break}et.exports.saveAs(new Blob([this.buffer],{type:n}),o)}this.buffer=null}_toTime(t){const o=t%60;return`00:${((t-o)/60).toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`}async _mixinMusic(){if(this.frames.length==0)return;this.ffmpeg.isLoaded()||await this.ffmpeg.load();const t="out.mp4",o="music.mp3",{delay:n,quality:l}=this.options,{file:s,start:g}=this.music,v=1e3/n,c=17+Math.round(l*10),m=n/1e3*this.frames.length;if((await new Jt(this.options).transforms(this.frames)).forEach(async(b,x)=>{this.ffmpeg.FS("writeFile",`${x}.jpg`,await ve.fetchFile(b))}),s){this.ffmpeg.FS("writeFile",o,await ve.fetchFile(s));const b=this._toTime(g);await this.ffmpeg.run("-r",`${v}`,"-f","image2","-i","%d.jpg","-i",o,"-ss",b,"-t",`${m}`,"-crf",`${c}`,t)}else await this.ffmpeg.run("-r",`${v}`,"-f","image2","-i","%d.jpg","-crf",`${c}`,t);this.buffer=this.ffmpeg.FS("readFile",t).buffer}}const T=e=>(ae("data-v-583b05f4"),e=e(),oe(),e),Qt={class:"form"},ea=T(()=>d("span",null,"\u5BBD / \u9AD8\uFF1A",-1)),ta=T(()=>d("span",null,"\u8D28\u91CF\uFF1A",-1)),aa=T(()=>d("span",{for:"rule"},"\u622A\u53D6\u89C4\u5219\uFF1A",-1)),oa=T(()=>d("option",{value:"1"},"\u653E\u5927",-1)),ia=T(()=>d("option",{value:"2"},"\u7B49\u6BD4\u7F29\u5C0F",-1)),na=T(()=>d("option",{value:"3"},"\u7B49\u6BD4\u653E\u5927",-1)),ra=[oa,ia,na],sa=T(()=>d("span",{for:"background"},"\u80CC\u666F\u8272\uFF1A",-1)),la=T(()=>d("span",{for:"delay"},"\u505C\u7559\u65F6\u95F4\uFF1A",-1)),da=T(()=>d("span",{for:"repeat"},"\u91CD\u590D\u6B21\u6570\uFF1A",-1)),ca=Y({__name:"gif-canvas",props:{value:null},emits:["update:value","change"],setup(e,{emit:t}){const o=e,n=L({width:o.value.width,height:o.value.height}),l=function(v){let c=o.value;v&&(c=Object.assign(c,v)),t("update:value",c),t("change")},s=function(v){l(v)},g=function(){l()};return(v,c)=>(O(),D("div",Qt,[d("div",null,[ea,E(tt,{value:n.value,onChange:s},null,8,["value"])]),d("div",null,[ta,d("div",null,[E(at,{ref:"scaleRange",value:e.value.quality,"onUpdate:value":c[0]||(c[0]=m=>e.value.quality=m),onChange:g},null,8,["value"])])]),d("div",null,[aa,d("div",null,[H(d("select",{name:"rule","onUpdate:modelValue":c[1]||(c[1]=m=>e.value.rule=m),onChange:l},ra,544),[[Re,e.value.rule]])])]),E(Pe),d("div",null,[sa,d("div",null,[H(d("input",{type:"color",name:"background","onUpdate:modelValue":c[2]||(c[2]=m=>e.value.background=m),onChange:l},null,544),[[te,e.value.background]])])]),d("div",null,[la,d("div",null,[H(d("input",{type:"number",name:"delay",min:"0",placeholder:"\u505C\u7559\u65F6\u95F4 \u6BEB\u79D2","onUpdate:modelValue":c[3]||(c[3]=m=>e.value.delay=m),onChange:l},null,544),[[te,e.value.delay]])])]),d("div",null,[da,d("div",null,[H(d("input",{type:"number",name:"repeat",min:"-1",placeholder:"-1 never 0 ever or number","onUpdate:modelValue":c[4]||(c[4]=m=>e.value.repeat=m),onChange:l},null,544),[[te,e.value.repeat]])])])]))}});var ua=M(ca,[["__scopeId","data-v-583b05f4"]]),fa="/tools/assets/music.ef09a6a4.mp3";const Ae=e=>(ae("data-v-660d7fa8"),e=e(),oe(),e),ga={class:"form"},pa=Ae(()=>d("span",null,"\u8D77\u59CB\u65F6\u95F4\uFF1A",-1)),va=Ae(()=>d("div",null," '../../assets/music.mp3' ",-1)),ha=Y({__name:"gif-music",props:{value:null},emits:["update:value","change"],setup(e,{emit:t}){const o=e;Ge(function(){n({file:fa})});const n=function(l){let s=o.value;l&&(s=Object.assign(s,l)),t("update:value",s),t("change")};return(l,s)=>(O(),D("div",ga,[d("div",null,[pa,d("div",null,[H(d("input",{type:"number",name:"start","onUpdate:modelValue":s[0]||(s[0]=g=>e.value.start=g),onChange:n},null,544),[[te,e.value.start]])])]),E(Pe),va]))}});var ma=M(ha,[["__scopeId","data-v-660d7fa8"]]);const ba={class:"list"},wa={class:"img"},ya=["src"],_a={class:"tools icon-group"},Fa=Y({__name:"FrameEditor",props:{list:null},setup(e,{expose:t}){const o=e,n=L([]);Me(o,function(){n.value=o.list.map(g=>{const v=n.value.find(c=>g.id==c.id);return v||Object.assign({rotateX:0,rotateY:0,rotateZ:0},g)})}),t({getFrames:function(){return n.value.map(g=>X({},g))}});const s=function(g){n.value[g].rotateY=n.value[g].rotateY==0?180:0};return(g,v)=>(O(),D("div",ba,[d("ul",null,[(O(!0),D(Se,null,Ne(n.value,(c,m)=>(O(),D("li",{key:c.id},[d("div",wa,[d("img",{src:c.src,alt:"",style:Ve({transform:`rotateX(${c.rotateX}deg) rotateY(${c.rotateY}deg) rotateZ(${c.rotateZ}deg)`})},null,12,ya),d("span",null,"\u7B2C "+qe(m+1)+" \u5E27",1)]),d("div",_a,[E(ot,{type:"flip-x",onClick:h=>s(m)},null,8,["onClick"])])]))),128))])]))}});var xa=M(Fa,[["__scopeId","data-v-67133cc0"]]);const ka={},$a={class:"dialog-loading global-loading"},Ea=Ye('<div class="global-loading-dot" data-v-ed30dbd0></div><div class="global-loading-dot" data-v-ed30dbd0></div><div class="global-loading-dot" data-v-ed30dbd0></div><div class="global-loading-dot" data-v-ed30dbd0></div><div class="global-loading-dot" data-v-ed30dbd0></div><div class="global-loading-dot" data-v-ed30dbd0></div><div class="global-loading-dot" data-v-ed30dbd0></div><div class="global-loading-dot" data-v-ed30dbd0></div><div class="global-loading-dot" data-v-ed30dbd0></div><div class="global-loading-dot" data-v-ed30dbd0></div><div class="global-loading-dot" data-v-ed30dbd0></div><div class="global-loading-dot" data-v-ed30dbd0></div>',12),Ca=[Ea];function La(e,t){return O(),D("div",$a,Ca)}var Sa=M(ka,[["render",La],["__scopeId","data-v-ed30dbd0"]]);const Pa=Y({__name:"Overlay",props:{show:{type:Boolean,default:!1}},setup(e){return(t,o)=>(O(),D("div",{class:he(["overlay",e.show?"overlay-show":""])},null,2))}});var Ba=M(Pa,[["__scopeId","data-v-07cab184"]]);const ja=e=>(ae("data-v-19456f35"),e=e(),oe(),e),Oa=["id"],Ia={class:"dialog-center-box"},Aa=ja(()=>d("span",{class:"css-icon delete bold"},null,-1)),Da=[Aa],Ua={key:1,class:"dialog-header"},za={class:"dialog-content"},Ta={key:2,class:"dialog-footer"},Ra=Y({__name:"Dialog",props:{size:{type:String,default:"max-content"},needClose:{type:Boolean,default:!0},show:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},emits:["update:show","update:loading"],setup(e,{emit:t}){const o=L(We()),n=Xe(),l=function(){t("update:show",!1),t("update:loading",!1)};return(s,g)=>(O(),D("div",{id:o.value,class:he(["dialog","dialog-"+e.size,e.show?"open":""])},[E(Ba,{show:e.show,onClick:l},null,8,["show"]),E(Sa,{class:he(["dialog-loading",e.loading?"show":""])},null,8,["class"]),d("div",Ia,[e.needClose?(O(),D("div",{key:0,class:"dialog-close",onClick:l},Da)):de("",!0),ke(n).header?(O(),D("div",Ua,[ce(s.$slots,"header",{},void 0,!0)])):de("",!0),d("div",za,[ce(s.$slots,"content",{},void 0,!0)]),ke(n).footer?(O(),D("div",Ta,[ce(s.$slots,"footer",{},void 0,!0)])):de("",!0)])],10,Oa))}});var Ga=M(Ra,[["__scopeId","data-v-19456f35"]]);const Ma=["src","width"],Na={class:"btn-group center"},Va=Y({__name:"PreViewDialog",props:{ratio:{type:Number,default:1}},emits:["footer-click"],setup(e,{expose:t,emit:o}){const n=L(""),l=window.screen.height*.6,s=L(!1),g=L(!1),v=function(F=!1){s.value=!0,g.value=F};t({display:function(F){n.value=F,v()},load:function(){v(!0)},open:v});const h=function(F){o("footer-click",F)};return(F,b)=>(O(),Ze(Ga,{show:s.value,"onUpdate:show":b[2]||(b[2]=x=>s.value=x),loading:g.value,"onUpdate:loading":b[3]||(b[3]=x=>g.value=x)},{content:z(()=>[d("video",{src:n.value,width:l*e.ratio,height:l,class:"preview",controls:"",autoplay:""},null,8,Ma)]),footer:z(()=>[d("div",Na,[d("button",{class:"button large C",onClick:b[0]||(b[0]=x=>h("gif"))},"\u4E0B\u8F7DGIF"),d("button",{class:"button large C",onClick:b[1]||(b[1]=x=>h("mp4"))},"\u4E0B\u8F7DMP4")])]),_:1},8,["show","loading"]))}});var qa=M(Va,[["__scopeId","data-v-50fd23d1"]]);const De=e=>(ae("data-v-8e00062e"),e=e(),oe(),e),Ya=De(()=>d("span",null,"Pic GIF",-1)),Wa=De(()=>d("button",{class:"button C"},[d("a",{href:"./collage.html"},"Pic Collage")],-1)),Xa={class:"left"},Za={class:"right"},Ha=Y({__name:"index",setup(e){const t=L([]),o=L("music"),n=L(""),l=L(),s=L(),g=L(),v=L({width:900,height:1600,repeat:0,delay:750,background:"#FFFFFF",rule:3,quality:.5}),c=L({start:0}),m=L([]),h=new Kt,F=()=>{Je(()=>{I.value=[],n.value="",b("\u6E05\u7406\u6210\u529F")})},b=w=>{t.value.push({value:w,timestamp:Le()})},x=function(){s.value.open()},R=async function(){var w=g.value.getFrames();if(!(!w||w.length==0)){s.value.load();var y=await h.setOpt(v.value).setMusic(c.value).setFrame(w).toPreView();s.value.display(y)}},G=function(w){var y=g.value.getFrames();!y||y.length==0||h.setOpt(v.value).setMusic(c.value).setFrame(y).toFile(w).catch(f=>{console.log(f)})},I=L([]),C=function(w){I.value=w};return(w,y)=>(O(),D(Se,null,[E(He,{needLog:!0},{header:z(()=>[Ya]),menu:z(()=>[Wa]),main:z(()=>[d("div",Xa,[E(it,{selected:o.value,"onUpdate:selected":y[1]||(y[1]=f=>o.value=f)},{default:z(()=>[E(ue,{key:"library",title:"\u56FE\u5E93"},{default:z(()=>[E(nt,{ref_key:"galleryLoader",ref:l,value:m.value,"onUpdate:value":y[0]||(y[0]=f=>m.value=f),onLog:b,need_decision:!0,onDecision:C},null,8,["value"])]),_:1}),E(ue,{key:"setting",title:"\u8BBE\u7F6E"},{default:z(()=>[E(ua,{value:v.value},null,8,["value"])]),_:1}),E(ue,{key:"music",title:"\u80CC\u666F\u97F3\u4E50"},{default:z(()=>[E(ma,{value:c.value},null,8,["value"])]),_:1})]),_:1},8,["selected"]),d("div",{class:"btn-group center"},[d("button",{class:"button large",onClick:R},"\u751F\u6210\u9884\u89C8"),d("button",{class:"button large",onClick:x},"\u6253\u5F00\u9884\u89C8")])]),d("div",Za,[d("div",{class:"btn-group right"},[d("button",{class:"button A",onClick:F},"\u6E05\u7406\u5E27")]),E(xa,{ref_key:"frameEditor",ref:g,list:I.value},null,8,["list"])])]),footer:z(()=>[E(rt,{logs:t.value},null,8,["logs"])]),_:1}),E(qa,{ref_key:"previewDialog",ref:s,ratio:v.value.width/v.value.height,onFooterClick:G},null,8,["ratio"])],64))}});var Ja=M(Ha,[["__scopeId","data-v-8e00062e"]]);Ke(Ja).mount("#app");
